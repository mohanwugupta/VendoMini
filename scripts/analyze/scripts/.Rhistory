metrics$model
senti_steps$model
merged <- senti_steps %>%
left_join(
metrics,
by = c("model" = "model", "step" = "event_index")
)
glimpse(merged)
View(merged)
netWorthPred <- merged %>%
filter(event_type == "net_worth")
merged <- senti_steps %>%
left_join(
metrics,
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(epoch.x, step, model) %>%
group_by(epoch.x, model) %>%
mutate(net_worth_filled = na.locf(value, na.rm = FALSE)) %>%
ungroup()
library(zoo)
merged <- senti_steps %>%
left_join(
metrics,
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(epoch.x, step, model) %>%
group_by(epoch.x, model) %>%
mutate(net_worth_filled = na.locf(value, na.rm = FALSE)) %>%
ungroup()
# align datasets
metrics <-  metrics %>%
mutate(model = str_extract(metadata, '(?<="model": ")[^"]+'))
merged <- senti_steps %>%
left_join(
metrics,
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(epoch.x, step, model) %>%
group_by(epoch.x, model) %>%
mutate(net_worth_filled = na.locf(value, na.rm = FALSE)) %>%
ungroup()
merged <- senti_steps %>%
left_join(
metrics,
by = c("model" = "model", "step" = "event_index")
)
merged <- senti_steps %>%
left_join(
metrics,
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(epoch.x, step, model) %>%
group_by(epoch.x, model) %>%
mutate(net_worth_filled = na.locf(value, na.rm = FALSE)) %>%
ungroup()
glimpse(merged)
merged <- senti_steps %>%
left_join(
metrics,
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(epoch.x, step, model) %>%
group_by(epoch.x, model) %>%
mutate(net_worth_filled = na.locf(net_worth, na.rm = FALSE)) %>%
ungroup()
glimpse(merged)
merged <- senti_steps %>%
left_join(
metrics %>%
mutate(
net_worth = ifelse(event_type == "net_worth", as.numeric(value), NA_real_)
) %>%
select(run_id, event_index, net_worth),   # keep only what we need
by = c("run_id" = "run_id", "step" = "event_index")
) %>%
arrange(epoch.x, step, model) %>%
group_by(epoch.x, model) %>%
mutate(net_worth_filled = na.locf(net_worth, na.rm = FALSE)) %>%
ungroup()
senti_steps %>%
left_join(
metrics %>%
mutate(
net_worth = ifelse(event_type == "net_worth", as.numeric(value), NA_real_)
) %>%
select(run_id, event_index, net_worth),   # keep only what we need
by = c("run_id" = "run_id", "step" = "event_index")
)
senti_steps %>%
left_join(
metrics %>%
mutate(
net_worth = ifelse(event_type == "net_worth", as.numeric(value), NA_real_)
) %>%
select(run_id, event_index, net_worth),   # keep only what we need
by = c("run_id" = "run_id", "step" = "event_index")
) %>%
arrange(epoch.x, step, model) %>%
group_by(epoch.x, model)
senti_steps %>%
left_join(
metrics %>%
mutate(
net_worth = ifelse(event_type == "net_worth", as.numeric(value), NA_real_)
) %>%
select(run_id, event_index, net_worth),   # keep only what we need
by = c("run_id" = "run_id", "step" = "event_index")
) %>%
arrange(epoch.x, step, model)
test <- senti_steps %>%
left_join(
metrics %>%
mutate(
net_worth = ifelse(event_type == "net_worth", as.numeric(value), NA_real_)
) %>%
select(run_id, event_index, net_worth),   # keep only what we need
by = c("run_id" = "run_id", "step" = "event_index")
)
View(test)
merged <- senti_steps %>%
left_join(
metrics %>%
mutate(
net_worth = ifelse(event_type == "net_worth", as.numeric(value), NA_real_)
) %>%
select(run_id, event_index, net_worth),   # keep only what we need
by = c("run_id" = "run_id", "step" = "event_index")
) %>%
arrange(epoch, step, model) %>%
group_by(epoch, model) %>%
mutate(net_worth_filled = na.locf(net_worth, na.rm = FALSE)) %>%
ungroup()
glimpse(merged)
merged <- senti_steps %>%
left_join(
metrics %>%
mutate(
net_worth = ifelse(event_type == "net_worth", as.numeric(value), NA_real_)
),
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(epoch.x, step, model) %>%
group_by(epoch.x, model) %>%
mutate(net_worth_filled = na.locf(value, na.rm = FALSE)) %>%
ungroup()
glimpse(merged)
merged <- senti_steps %>%
left_join(
metrics %>%
mutate(
net_worth = ifelse(event_type == "net_worth", as.numeric(value), NA_real_)
),
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(epoch.x, step, model) %>%
group_by(epoch.x, model) %>%
mutate(net_worth_filled = na.locf(net_worth, na.rm = FALSE)) %>%
ungroup()
glimpse(merged)
merged <- senti_steps %>%
left_join(
metrics %>%
filter(event_type == "net_worth") %>%              # keep only net worth events
mutate(net_worth = as.numeric(value)) %>%
select(run_id, event_index, net_worth),            # join only clean net worth
by = c("run_id" = "run_id", "step" = "event_index")
) %>%
arrange(epoch.x, step, model) %>%
group_by(epoch.x, model) %>%
mutate(net_worth_filled = na.locf(net_worth, na.rm = FALSE)) %>%
ungroup()
merged <- senti_steps %>%
left_join(
metrics %>%
filter(event_type == "net_worth") %>%              # keep only net worth events
mutate(net_worth = as.numeric(value)) %>%
by = c("run_id" = "run_id", "step" = "event_index")
merged <- senti_steps %>%
left_join(
metrics %>%
filter(event_type == "net_worth") %>%              # keep only net worth events
mutate(net_worth = as.numeric(value)) %>%         # join only clean net worth
by = c("run_id" = "run_id", "step" = "event_index")
merged <- senti_steps %>%
left_join(
metrics %>%
filter(event_type == "net_worth") %>%              # keep only net worth events
mutate(net_worth = as.numeric(value)) %>%         # join only clean net worth
by = c("run_id" = "run_id", "step" = "event_index")) %>%
merged <- senti_steps %>%
left_join(
metrics %>%
filter(event_type == "net_worth") %>%              # keep only net worth events
mutate(net_worth = as.numeric(value)),         # join only clean net worth
by = c("run_id" = "run_id", "step" = "event_index")) %>%
arrange(epoch.x, step, model) %>%
group_by(epoch.x, model) %>%
mutate(net_worth_filled = na.locf(net_worth, na.rm = FALSE)) %>%
ungroup()
merged <- senti_steps %>%
left_join(
metrics %>%
filter(event_type == "net_worth") %>%              # keep only net worth events
mutate(net_worth = as.numeric(value)) %>%
select(run_id, event_index, net_worth),            # join only clean net worth
by = c("run_id" = "run_id", "step" = "event_index")
) %>%
arrange(epoch, step, model) %>%
group_by(epoch, model) %>%
mutate(net_worth_filled = na.locf(net_worth, na.rm = FALSE)) %>%
ungroup()
glimpse(merged)
merged <- senti_steps %>%
left_join(
metrics %>%
filter(event_type == "net_worth") %>%
mutate(net_worth = as.numeric(value)) %>%
select(model, event_index, net_worth),   # use model + event_index
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(epoch, step, model) %>%
group_by(epoch, model) %>%
mutate(net_worth_filled = zoo::na.locf(net_worth, na.rm = FALSE)) %>%
ungroup()
glimpse(merged)
merged <- senti_steps %>%
left_join(
metrics %>%
filter(event_type == "net_worth") %>%
mutate(net_worth = as.numeric(value)) %>%
select(model, event_index, net_worth),
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(model, epoch, step) %>%           # ensure proper order
group_by(model) %>%                       # carry forward within each model
mutate(net_worth_filled = zoo::na.locf(net_worth, na.rm = FALSE)) %>%
ungroup()
glimpse(merged)
merged <- senti_steps %>%
left_join(
metrics %>%
filter(event_type == "net_worth") %>%
mutate(net_worth = as.numeric(value)) %>%
select(model, event_index, net_worth),
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(model, epoch, step) %>%           # ensure proper order
group_by(model, epoch) %>%                       # carry forward within each model
mutate(net_worth_filled = zoo::na.locf(net_worth, na.rm = FALSE)) %>%
ungroup()
glimpspe(merged)
glimpse(merged)
View(merged)
lm(net_worth_filled ~ vader_compound + message_length + epoch + lag(net_worth, 1), data = merged)
lmModel <- lm(net_worth_filled ~ vader_compound + message_length + epoch + lag(net_worth, 1), data = merged)
glimpse(lmModel)
summary(lmModel)
library(randomForest)
install.packages("randomForest")
library(randomForest)
rf_model <- randomForest(
net_worth_filled ~ vader_compound + message_length + epoch + lag(net_worth, 1),
data = merged,
ntree = 500,
mtry = 3,
importance = TRUE
)
merged <- senti_steps %>%
left_join(
metrics %>%
filter(event_type == "net_worth") %>%
mutate(net_worth = as.numeric(value)) %>%
select(model, event_index, net_worth),
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(model, epoch, step) %>%           # ensure proper order
group_by(model, epoch) %>%                       # carry forward within each model
mutate(net_worth_filled = zoo::na.locf(net_worth, na.rm = FALSE)) %>%
ungroup() %>%
mutate(net_worth_filled = ifelse(is.na(net_worth_filled), 500, net_worth))
lmModel <- lm(net_worth_filled ~ vader_compound + message_length + epoch + lag(net_worth, 1), data = merged)
summary(lmModel)
View(merged)
merged <- senti_steps %>%
left_join(
metrics %>%
filter(event_type == "net_worth") %>%
mutate(net_worth = as.numeric(value)) %>%
select(model, event_index, net_worth),
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(model, epoch, step) %>%           # ensure proper order
group_by(model, epoch) %>%                       # carry forward within each model
mutate(net_worth_filled = zoo::na.locf(net_worth, na.rm = FALSE))
merged <- senti_steps %>%
left_join(
metrics %>%
filter(event_type == "net_worth") %>%
mutate(net_worth = as.numeric(value)) %>%
select(model, event_index, net_worth),
by = c("model" = "model", "step" = "event_index")
) %>%
arrange(model, epoch, step) %>%           # ensure proper order
group_by(model, epoch) %>%                       # carry forward within each model
mutate(net_worth_filled = zoo::na.locf(net_worth, na.rm = FALSE)) %>%
ungroup() %>%
mutate(net_worth_filled = replace_na(net_worth, 500))
lmModel <- lm(net_worth_filled ~ vader_compound + message_length + epoch + lag(net_worth, 1), data = merged)
summary(lmModel)
set.seed(123)
rf_model <- randomForest(
net_worth_filled ~ vader_compound + message_length + epoch + lag(net_worth, 1),
data = merged,
ntree = 500,
mtry = 3,
importance = TRUE
)
rf_model <- randomForest(
net_worth_filled ~ vader_compound + message_length + epoch,
data = merged,
ntree = 500,
mtry = 3,
importance = TRUE
)
rf_model
summary(rf_model)
rf_model
glimpse(merged)
lmModel <- lm(net_worth_filled ~ vader_compound + message_length + epoch + lag(net_worth, 1) + max_word_repetition, data = merged)
summary(lmModel)
glimpse(merged)
lmModel <- lm(net_worth_filled ~ vader_compound + message_length + epoch + lag(net_worth, 1) + max_word_repetition, data = merged)
summary(lmModel)
set.seed(123)
rf_model <- randomForest(
net_worth_filled ~ vader_compound + message_length + epoch + max_word_repetition,
data = merged,
ntree = 500,
mtry = 3,
importance = TRUE
)
summary(lmModel)
merged$predicted <- predict(model, newdata = merged)
merged$predicted <- predict(lmModel, newdata = merged)
ggplot(merged, aes(x = predicted, y = net_worth_filled)) +
geom_point(alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color = "red") +
theme_minimal() +
labs(x = "Predicted", y = "Actual Net Worth")
ggplot(merged, aes(x = predicted, y = net_worth_filled)) +
geom_point(alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color = "red") +
theme_minimal() +
labs(x = "Predicted", y = "Actual Net Worth")
importance(rf_model)
varImpPlot(rf_model)
rf_model <- randomForest(
net_worth_filled ~ vader_compound + message_length + epoch + max_word_repetition,
data = merged,
ntree = 1000,
mtry = 4,
importance = TRUE
)
library(pdp)
importance(rf_model)
varImpPlot(rf_model)
rf_model
rf_model <- randomForest(
net_worth_filled ~ vader_compound + message_length + epoch + max_word_repetition,
data = merged,
ntree = 500,
mtry = 3,
importance = TRUE
)
rf_model
library(forecast)
install.packages("forecast")
library(forecast)
fit <- auto.arima(merged$net_worth_filled)
summary(fit)
lmModel <- lm(net_worth_filled ~ model, vader_compound + message_length + epoch + lag(net_worth, 1) + max_word_repetition, data = merged)
summary(lmModel)
lmModel <- lm(net_worth_filled ~ model * vader_compound * message_length * epoch * lag(net_worth, 1) * max_word_repetition, data = merged)
lmModel <- lm(net_worth_filled ~ model * vader_compound * message_length * epoch * lag(net_worth, 1) * max_word_repetition, data = merged)
summary(lmModel)
lmModel <- lm(net_worth_filled ~ model + vader_compound + message_length + epoch + lag(net_worth, 1) + max_word_repetition, data = merged)
summary(lmModel)
# if you want to include predictors
xreg <- merged[,c("vader_compound", "message_length")]
fit_xreg <- auto.arima(merged$net_worth_filled, xreg = as.matrix(xreg))
forecast(fit_xreg, xreg = as.matrix(future_xreg), h = 10)
xreg <- merged[,c("vader_compound", "message_length")]
fit_xreg <- auto.arima(merged$net_worth_filled, xreg = as.matrix(xreg))
forecast(fit_xreg, xreg = as.matrix(future_xreg), h = 10)
fit <- auto.arima(
y = merged$net_worth_filled,
xreg = merged[,c("vader_compound", "message_length", "model")]
)
fit <- auto.arima(
y = merged$net_worth_filled,
xreg = merged[,c("vader_compound", "message_length", "model")]
)
fit <- auto.arima(
y = merged$net_worth_filled,
xreg = as.matrix(merged[, c("vader_compound", "message_length")])
)
summary(fit)
# ARIMAX
fit <- auto.arima(
y = merged$net_worth_filled,
xreg = as.matrix(merged[, c("vader_compound", "message_length",
"epoch", "message_length", "max_word_repetition")])
)
# ARIMAX
fit <- auto.arima(
y = merged$net_worth_filled,
xreg = as.matrix(merged[, c("vader_compound", "message_length",
"model", "message_length", "max_word_repetition")])
)
# ARIMAX
fit <- auto.arima(
y = merged$net_worth_filled,
xreg = as.matrix(merged[, c("vader_compound", "message_length", "model", "message_length", "max_word_repetition")])
)
# ARIMAX
# turn predictors into a numeric design matrix (one-hot encode model)
xreg <- model.matrix(
~ vader_compound + message_length + model + max_word_repetition,
data = merged
)[, -1]   # remove intercept column to avoid duplication
fit <- auto.arima(
y = merged$net_worth_filled,
xreg = xreg
)
summary(fit)
checkresiduals(fit)
fit_log <- auto.arima(log1p(merged$net_worth_filled), xreg = xreg)
summary(fit_log)
fitted_vals <- exp(fitted(fit)) - 1
plot(merged$net_worth_filled, type="l", col="black")
fitted_vals <- exp(fitted(fit)) - 1
plot(merged$net_worth_filled, type="l", col="black")
fitted_vals <- exp(fitted(fit)) - 1
plot(merged$net_worth_filled, type="l", col="black")
fitted_vals <- exp(fitted(fit)) - 1
plot(merged$net_worth_filled, type="l", col="black")
lines(fitted_vals, col="red")
fitted_vals <- exp(fitted(fit)) - 1
plot(merged$net_worth_filled, type="l", col="black",
main="Actual vs Fitted Net Worth", ylab="Net Worth", xlab="Index")
lines(fitted_vals, col="red")
legend("topleft", legend=c("Actual", "Fitted"), col=c("black","red"), lty=1)
plot(merged$net_worth_filled[1:1000], type="l", col="black")
lines(fitted_vals[1:1000], col="red")
df_plot <- data.frame(
step = seq_along(merged$net_worth_filled),
actual = merged$net_worth_filled,
fitted = fitted_vals
)
ggplot(df_plot, aes(x=step)) +
geom_line(aes(y=actual), color="black") +
geom_line(aes(y=fitted), color="red") +
labs(title="Actual vs Fitted Net Worth", y="Net Worth", x="Step") +
theme_minimal()
keep <- seq(1, nrow(df_plot), by=10)  # keep every 10th point
ggplot(df_plot[keep,], aes(x=step)) +
geom_line(aes(y=actual), color="black") +
geom_line(aes(y=fitted), color="red")
plot(merged$net_worth_filled[1:1000], type="l", col="black")
lines(fitted_vals[1:1000], col="red")
# fitted values back-transformed
fitted_vals <- exp(fitted(fit)) - 1
# forecast next 50 steps (example, adjust h)
fc <- forecast(fit, xreg = xreg_future, h = 50)
lmModel <- lm(net_worth_filled ~ model + vader_compound + message_length + epoch + lag(net_worth, 1) + max_word_repetition, data = merged)
summary(lmModel)
merged$predicted <- predict(lmModel, newdata = merged)
ggplot(merged, aes(x = predicted, y = net_worth_filled)) +
geom_point(alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color = "red") +
theme_minimal() +
labs(x = "Predicted", y = "Actual Net Worth")
set.seed(123)
# bad model - not explaining any more than the mean
rf_model <- randomForest(
net_worth_filled ~ vader_compound + message_length + epoch + max_word_repetition,
data = merged,
ntree = 500,
mtry = 3,
importance = TRUE
)
# bad model - not explaining any more than the mean
rf_model <- randomForest(
net_worth_filled ~ vader_compound + message_length + epoch + max_word_repetition,
data = merged,
ntree = 500,
mtry = 3,
importance = TRUE
)
importance(rf_model)
varImpPlot(rf_model)
# ARIMAX
# turn predictors into a numeric design matrix (one-hot encode model)
xreg <- model.matrix(
~ vader_compound + message_length + model + max_word_repetition,
data = merged
)[, -1]   # remove intercept column to avoid duplication
fit <- auto.arima(
y = merged$net_worth_filled,
xreg = xreg
)
